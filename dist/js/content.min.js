!(function (e, t) {
  e &&
    !e.getElementById("livereloadscript") &&
    (((t = e.createElement("script")).async = 1),
    (t.src =
      "//" +
      (self.location.host || "localhost").split(":")[0] +
      ":35729/livereload.js?snipver=1"),
    (t.id = "livereloadscript"),
    e.getElementsByTagName("head")[0].appendChild(t));
})(self.document),
  (function () {
    "use strict";
    console.info("【格式化插件】Text formatting init.");
    var e = (function (e) {
        switch (((e = e || location.href), !0)) {
          case /docs\.google\.com\/spreadsheets/i.test(e):
            return "GoogleExcel";
          case /docs\.google\.com\/document/i.test(e):
            return "GoogleDocs";
          default:
            return "Unknown";
        }
      })(),
      t = window.getSelection();
    console.info("【格式化插件】当前插件宿主：", e),
      chrome.runtime.onMessage.addListener(function (o) {
        if ((console.log("request", o), 1 === o.code)) {
          var n = pangu.spacing(o.message);
          if (
            (console.log("【格式化插件】替换前文本：", o.message),
            console.log("【格式化插件】替换后文本：", n),
            n && o.isEditable)
          ) {
            if (1 == ("GoogleExcel" === e))
              return void (function (e) {
                if (window.getSelection && t.rangeCount > 0) {
                  var o = t.getRangeAt(0),
                    n = document.createTextNode(e);
                  o.deleteContents(),
                    o.insertNode(n),
                    t.removeAllRanges(),
                    t.addRange(o);
                } else
                  document.selection &&
                    "Control" != document.selection.type &&
                    (document.selection.createRange().text = e);
              })(n);
            console.log("【格式化插件】通用框逻辑"),
              (function (e) {
                var t = document.activeElement;
                if ("INPUT" === t.tagName || "TEXTAREA" === t.tagName) {
                  var o = t.selectionStart,
                    n = t.selectionEnd,
                    s = t.value.substring(0, o) + e + t.value.substring(n);
                  t.value = s;
                  var l = o + e.length;
                  t.setSelectionRange(l, l);
                }
              })(n);
          }
        }
      });
  })();
//# sourceMappingURL=content.min.js.map
